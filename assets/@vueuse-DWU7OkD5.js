import{t as U,e as O,r as y,f as W,s as w,w as S,j,k as G,c as g,l as b,b as L,g as P,u as T,m as _}from"./@vue-1j5V9ATP.js";import{Q as q}from"./qrcode-cp1lJVLl.js";const I=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const A=()=>{};function Q(...e){if(e.length!==1)return U(...e);const t=e[0];return typeof t=="function"?O(W(()=>({get:t,set:A}))):y(t)}function Y(e,t){const u=Q(e),s=w("");return S(u,async l=>{u.value&&I&&(s.value=await q.toDataURL(l,t))},{immediate:!0}),s}function R(e){return j()?(G(e),!0):!1}const C=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const $=Object.prototype.toString,x=e=>$.call(e)==="[object Object]";function B(e){let t;function u(){return t||(t=e()),t}return u.reset=async()=>{const s=t;t=void 0,s&&await s},u}function D(e){return Array.isArray(e)?e:[e]}function N(e,t,u){return S(e,t,{...u,immediate:!0})}const V=C?window:void 0,k=C?window.navigator:void 0;function z(e){var t;const u=b(e);return(t=u==null?void 0:u.$el)!=null?t:u}function E(...e){const t=[],u=()=>{t.forEach(a=>a()),t.length=0},s=(a,n,o,r)=>(a.addEventListener(n,o,r),()=>a.removeEventListener(n,o,r)),l=g(()=>{const a=D(b(e[0])).filter(n=>n!=null);return a.every(n=>typeof n!="string")?a:void 0}),i=N(()=>{var a,n;return[(n=(a=l.value)==null?void 0:a.map(o=>z(o)))!=null?n:[V].filter(o=>o!=null),D(b(l.value?e[1]:e[0])),D(T(l.value?e[2]:e[1])),b(l.value?e[3]:e[2])]},([a,n,o,r])=>{if(u(),!(a!=null&&a.length)||!(n!=null&&n.length)||!(o!=null&&o.length))return;const c=x(r)?{...r}:r;t.push(...a.flatMap(p=>n.flatMap(m=>o.map(d=>s(p,m,d,c)))))},{flush:"post"}),v=()=>{i(),u()};return R(u),v}function F(){const e=y(!1),t=P();return t&&L(()=>{e.value=!0},t),e}function M(e){const t=F();return g(()=>(t.value,!!e()))}function H(e,t={}){const{controls:u=!1,navigator:s=k}=t,l=M(()=>s&&"permissions"in s),i=w(),v={name:e},a=w(),n=()=>{var r,c;a.value=(c=(r=i.value)==null?void 0:r.state)!=null?c:"prompt"};E(i,"change",n,{passive:!0});const o=B(async()=>{if(l.value){if(!i.value)try{i.value=await s.permissions.query(v)}catch(r){i.value=void 0}finally{n()}if(u)return _(i.value)}});return o(),u?{state:a,isSupported:l,query:o}:a}function Z(e={}){const{navigator:t=k,requestPermissions:u=!1,constraints:s={audio:!0,video:!0},onUpdated:l}=e,i=y([]),v=g(()=>i.value.filter(d=>d.kind==="videoinput")),a=g(()=>i.value.filter(d=>d.kind==="audioinput")),n=g(()=>i.value.filter(d=>d.kind==="audiooutput")),o=M(()=>t&&t.mediaDevices&&t.mediaDevices.enumerateDevices),r=y(!1);let c;async function p(){o.value&&(i.value=await t.mediaDevices.enumerateDevices(),l==null||l(i.value),c&&(c.getTracks().forEach(d=>d.stop()),c=null))}async function m(){if(!o.value)return!1;if(r.value)return!0;const{state:d,query:f}=H("camera",{controls:!0});if(await f(),d.value!=="granted"){let h=!0;try{c=await t.mediaDevices.getUserMedia(s)}catch(J){c=null,h=!1}p(),r.value=h}else r.value=!0;return r.value}return o.value&&(u&&m(),E(t.mediaDevices,"devicechange",p,{passive:!0}),p()),{devices:i,ensurePermissions:m,permissionGranted:r,videoInputs:v,audioInputs:a,audioOutputs:n,isSupported:o}}function ee(e={}){var t,u;const s=y((t=e.enabled)!=null?t:!1),l=y((u=e.autoSwitch)!=null?u:!0),i=y(e.constraints),{navigator:v=k}=e,a=M(()=>{var f;return(f=v==null?void 0:v.mediaDevices)==null?void 0:f.getUserMedia}),n=w();function o(f){switch(f){case"video":{if(i.value)return i.value.video||!1;break}case"audio":{if(i.value)return i.value.audio||!1;break}}}async function r(){if(!(!a.value||n.value))return n.value=await v.mediaDevices.getUserMedia({video:o("video"),audio:o("audio")}),n.value}function c(){var f;(f=n.value)==null||f.getTracks().forEach(h=>h.stop()),n.value=void 0}function p(){c(),s.value=!1}async function m(){return await r(),n.value&&(s.value=!0),n.value}async function d(){return c(),await m()}return S(s,f=>{f?r():c()},{immediate:!0}),S(i,()=>{l.value&&n.value&&d()},{immediate:!0}),R(()=>{p()}),{isSupported:a,stream:n,start:m,stop:p,restart:d,constraints:i,enabled:s,autoSwitch:l}}export{ee as a,Y as b,Z as u};
//# sourceMappingURL=@vueuse-DWU7OkD5.js.map
